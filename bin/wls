#!/bin/sh

#
# 作業ログ検索 (Worklog search)
#
# Emacsで作成した作業ログ内から検索する
#
# Usage:
#  wls [option] keyword
#
#  option example:
#  - "--color never" ... 出力の色設定を無効化
#
# Tips:
#  - 検索結果のパス文字列をまとめて置換する
#    > wls "$1" | sed -e "s|path1|path2|g"
#


if [ "$1" == "" ]; then
  echo "No keywords specified"
  exit
fi

WLS_OPTIONS=""

if [ "$INSIDE_EMACS" = "" ]; then
  WLS_OPTIONS="--color never"
else
  WLS_OPTIONS="--color always"
fi

WORKLOG_DIR=$(cygpath -w "$EMACS_HOME/var/junk/worklog")

rg --no-heading --vimgrep -n --ignore-case --no-column --path-separator '/' --sort path $WLS_OPTIONS $2 -- "$1" "$WORKLOG_DIR"
